-- x: 60000x784
-- targets: 60000x10
Î»x.Î»targets.
Î»l1.Î»l2.
  {
    softmax â† Î»xs.
      { m âŸœ (â‹‰)/* _1 xs; a âŸœ [e:(x-m)]`{0} xs
      ; sum â† [(+)/x]
      ; n âŸœ sum`{1} (a::M float)
      ; â‰([(%x)'y]`{0,1} n a)
      };
    dsoftmax â† Î»xs.
        { m âŸœ (â‹‰)/* _1 xs; a âŸœ [e:(x-m)]`{0} xs
        ; sum â† [(+)/x]
        ; n âŸœ sum`{1} (a::M float)
        ; â‰([x*(1-x)]`{0} ([(%x)'y]`{0,1} n a))
        };
    dsigmoid â† ((Î»x.â¸xâŸœâ„¯(_x);x%(1+x)^2)`{0});
    -- fw
    xl1p âŸœ x%.l1;
    xSigmoid â† [1%(1+â„¯(_x))]`{0} xl1p;
    xl2p âŸœ xSigmoid%.l2;
    out â† softmax xl2p;
    -- bw
    error âŸœ (*)`{0,0} ({nâŸœ2%(â„(ğ“‰out)); [x*n]`{0} ((-)`{0,0} out targets)}) (dsoftmax xl2p);
    ul2 â† (â‰xSigmoid)%.error;
    ul1 â† (â‰x)%.((*)`{0,0} (â‰(l2%.(â‰error))) (dsigmoid xl1p));
    ((+)`{0,0} l1 ul1, (+)`{0,0} l2 ul2)
  }
